<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Test Date</title>
		<script>
function onLoad()
{
	var
		d1,
		d2,
		d3,
		offset,
		str;

	if(window.console && console.log) {
		d1 = Date.now();
		console.log("%%o=%o %%i=%i %%d=%d %%f=%f", d1, d1, d1, d1);
		
		d1 = new Date("2021-09-09T00:00:00+03:00");
		d2 = new Date(d1.getFullYear(), d1.getMonth());
		console.log("new Date(%i, %i)=\"%s\"", d1.getFullYear(), d1.getMonth(), d2.toLocaleString());
		
		d2 = new Date(d1.getFullYear(), d1.getMonth(), d1.getDate());
		console.log("new Date(%i, %i, %i)=\"%s\"", d1.getFullYear(), d1.getMonth(), d1.getDate(), d2.toLocaleString());
		
		str = `${d1.getFullYear()}-${d1.getMonth() + 1 < 10 ? `0${d1.getMonth() + 1}` : d1.getMonth() + 1}-${d1.getDate() < 10 ? `0${d1.getDate()}` : d1.getDate()}`;
		d3 = new Date(str);
		console.log("\"%s\" \"%s\" \"%s\" %o%s==%o %o %o", str, d2.toUTCString(), d3.toUTCString(), d2.valueOf(), d2.valueOf() === d3.valueOf() ? "=" : "!", d3.valueOf(), d2, d3);
		
		str = `${d1.getFullYear()}-${d1.getMonth() + 1 < 10 ? `0${d1.getMonth() + 1}` : d1.getMonth() + 1}-${d1.getDate() < 10 ? `0${d1.getDate()}` : d1.getDate()}T00:00:00`;
		d3 = new Date(str);
		console.log("\"%s\" \"%s\" \"%s\" %o%s==%o %o %o", str, d2.toUTCString(), d3.toUTCString(), d2.valueOf(), d2.valueOf() === d3.valueOf() ? "=" : "!", d3.valueOf(), d2, d3);
		
		d1 = new Date("2020-02-29T02:00:00+02:00");
		d2 = new Date("2020-02-28T16:00:00-08:00");
		console.log("\"2020-02-29T02:00:00+02:00\"=\"%s\" \"2020-02-28T16:00:00-08:00\"=\"%s\" %o%s==%o", d1.toUTCString(), d2.toUTCString(), d1.valueOf(), d1.valueOf() === d2.valueOf() ? "=" : "!", d2.valueOf());
		
		d1 = createDate();
		d1 = createDate("2021-11-058");
		d1 = createDate("2021-11-05");
		d1 = createDate("2021-11-05", "12:05");
		d1 = createDate("2021-11-05", "12:05:04");
		d1 = createDate("2021-11-05", "12:05:045");

		d1 = new Date("2021-11-07T00:00:00");
		console.log(d1);
		
		d1 = new Date();
		str = d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: false, timeZoneName: "short" });
		console.log(str);

		str = "2020-02-29T00:00:00+02:00";
		d1 = new Date(str);
		d2 = Date.parse(str);
		console.log("new Date(\"%s\") %o %s %s", str, d1, d1.toLocaleString(), d1.toUTCString());
		console.log("Date.parse(\"%s\") %o", str, d2);
		
		d1 = new Date(2020, 8, 28);
		console.log("new Date(2020, 8, 28) %o %s %s %s", d1, d1.toLocaleString(), d1.toUTCString(), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));
		
		str = "2020-09-28";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %o %s %s %s", str, d1, d1.toLocaleString(), d1.toUTCString(), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));
		
		str = "2021-10-11T22:23:42";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %o %s %s %s", str, d1, d1.toLocaleString(), d1.toUTCString(), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));
		
		str = "2020-09-28T00:00:00-07:00";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %s", str, d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));

		str = "2020-12-28T00:00:00-08:00";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %s", str, d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));

		str = "2020-09-28T07:00:00Z";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %s", str, d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));
		
		str = "2020-12-31T08:00:00Z";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %s", str, d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", year: "numeric", month: "2-digit", day: "2-digit", hour: "2-digit", minute: "2-digit", second: "2-digit", hour12: true, timeZoneName: "short" }));
		
		str = "2021-09-30T23:59:59+02:00";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %o %s %s %s %s", str, d1, d1.toString(), d1.toUTCString(), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", timeZoneName: "short" }), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", timeZoneName: "shortGeneric" }));

		str = "2011-12-31T23:59:59+02:00";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %o %s %s %s %s", str, d1, d1.toString(), d1.toUTCString(), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", timeZoneName: "short" }), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", timeZoneName: "shortGeneric" }));

		str = "2011-12-31T23:59:59.0000000Z";
		d1 = new Date(str);
		console.log("new Date(\"%s\") %o %s %s %s", str, d1, d1.toString(), d1.toUTCString(), d1.toLocaleString("en-US", { timeZone: "America/Los_Angeles", timeZoneName: "longOffset" }));
		
		d1 = new Date(2020, 1, 29, 23, 59, 59, 0);
		console.log("new Date(2020, 1, 29, 23, 59, 59, 0) %o %s %s", d1, d1.toString(), d1.toUTCString());
		
		d1 = new Date(Date.UTC(2020, 1, 29, 23, 59, 59, 0));
		console.log("new Date(Date.UTC(2020, 1, 29, 23, 59, 59, 0)) %o %s %s", d1, d1.toString(), d1.toUTCString());

		d1 = Date.now(),
		d2 = new Date(d1);
		console.log("Date.now() %o %s %s", d1, d2.toString(), d2.toUTCString());

		d1 = new Date(2017, 9, 28),
		d2 = new Date(d1.getTime() + 60 * 60 * 24 * 1000);
		offset = d2.getTimezoneOffset() - d1.getTimezoneOffset();
		console.log("d1.toString() = %s %i", d1.toString(), d1.getTimezoneOffset());
		console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());

		d1 = new Date(2017, 9, 29),
		d2 = new Date(d1.getTime() + 60 * 60 * 24 * 1000);
		offset = d2.getTimezoneOffset() - d1.getTimezoneOffset();
		console.log("d1.toString() = %s %i %i", d1.toString(), d1.getTimezoneOffset(), d1.getTime());
		console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());

		if (offset) {
			d2 = new Date(d2.getTime() + offset * 60 * 1000);
			console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());
		}

		d1 = new Date(2017, 9, 30),
		d2 = new Date(d1.getTime() + 60 * 60 * 24 * 1000);
		offset = d2.getTimezoneOffset() - d1.getTimezoneOffset();
		console.log("d1.toString() = %s %i", d1.toString(), d1.getTimezoneOffset());
		console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());

		d1 = new Date(2018, 2, 24),
		d2 = new Date(d1.getTime() + 60 * 60 * 24 * 1000);
		offset = d2.getTimezoneOffset() - d1.getTimezoneOffset();
		console.log("d1.toString() = %s %i", d1.toString(), d1.getTimezoneOffset());
		console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());

		d1 = new Date(2018, 2, 25),
		d2 = new Date(d1.getTime() + 60 * 60 * 24 * 1000);
		offset = d2.getTimezoneOffset() - d1.getTimezoneOffset();
		console.log("d1.toString() = %s %i", d1.toString(), d1.getTimezoneOffset());
		console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());

		if (offset) {
			d2 = new Date(d2.getTime() + offset * 60 * 1000);
			console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());
		}

		d1 = new Date(2018, 2, 26),
		d2 = new Date(d1.getTime() + 60 * 60 * 24 * 1000);
		offset = d2.getTimezoneOffset() - d1.getTimezoneOffset();
		console.log("d1.toString() = %s %i", d1.toString(), d1.getTimezoneOffset());
		console.log("d2.toString() = %s %i", d2.toString(), d2.getTimezoneOffset());

		d1 = new Date(2011,2,31);
		d2 = new Date(2011,2,31);

		d1.valueOf = function() {
			if (window.console)
				console.log("d1.valueOf()");

			return 0;
		};

		d2.valueOf = function() {
			if (window.console)
				console.log("d2.valueOf()");

			return 0;
		};

		offset = d1 - d2;
	}
}

function createDate(date, time) {
    const datePart = !!date && /^\d{4}-\d{2}-\d{2}$/.test(date) ? date : undefined;
    let timePart = !!time && /^\d{2}:\d{2}(:\d{2})?$/.test(time) ? time : undefined;
    
    if (!!timePart && timePart.length === 5) {
      timePart += ':00';
    }

    const dateTime = datePart ? `${datePart}${(timePart ? `T${timePart}` : '')}` : undefined;

	let result = new Date();
	
	if (dateTime) {
		const [, year = 0, month = 0, day = 0, hours = 0, minutes = 0, seconds = 0, milliseconds = 0] = /^(\d{4})-(\d{2})-(\d{2})(?:T(\d{2}):(\d{2}):(\d{2}))?$/.exec(dateTime);
		result = new Date(+year, month - 1, +day, +hours, +minutes, +seconds, milliseconds);
	}
	
    return result;
}
		</script>
	</head>
	<body onload="onLoad()">
	</body>
</html>
