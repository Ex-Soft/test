<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Test Override</title>
		<script>
function OnLoad()
{
	var
		o = {
			foo: function() {
				if(window.console && console.log)
					console.log("foo(%o) (original)", arguments);

				return arguments;
			},

			callOverridden: function(args) {
				//var a = arguments; // without this line this.callOverridden.caller===null
				return this.callOverridden.caller.$previous.apply(this, args);
			},

			override: function(overrides) {
				for(f in overrides)
					if(typeof this[f] === "function")
					{
						overrides[f].$previous = this[f];
						this[f] = overrides[f];
					}
			}
		};

	o.override({
		foo: function() {
			if(window.console && console.log)
				console.log("foo(%o) (b4 original)", arguments);

			this.callOverridden(arguments);

			if(window.console && console.log)
				console.log("foo(%o) (after original)", arguments);
		}
	});

	o.foo(1, 2, 3);
}
		</script>
	</head>
	<body onload="OnLoad()">
	</body>
</html>
