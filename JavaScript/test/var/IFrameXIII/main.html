<html>
	<head>
		<title>Main Form</title>
		<script type="text/javascript">
<!--
function DoIt()
{
	var
		frm,
		Ctrl,
		DynamicCtrlId="InputTextDynamic";

	if(frm=document.getElementById("IFrame1"))
	{
		if(Ctrl=frm.contentWindow.document.getElementById("InputTextStatic"))
			Show(frm.contentWindow.document,Ctrl);
		if(!(Ctrl=frm.contentWindow.document.getElementById(DynamicCtrlId))
			&& (Ctrl=frm.contentWindow.document.createElement("input")))
		{
			Ctrl.id=DynamicCtrlId;
			Ctrl.value="9876543210";
			frm.contentWindow.document.body.appendChild(Ctrl);
		}
		Show(frm.contentWindow.document,Ctrl);
	}
}

function Show(doc,Ctrl)
{
	var
		rng;

	if(doc.selection && doc.selection.createRange)
	{
		if(!(rng=doc.selection.createRange()))
			return;

		alert(rng.text);
	}
	if(doc.getSelection) 
	{
		Ctrl.selectionStart-=1;
		alert(Ctrl.value.substring(Ctrl.selectionStart,Ctrl.selectionEnd)); 
	}
}
// -->
		</script>
	</head>
	<body>
		<iframe id="IFrame1" src="iframe1.html"></iframe><br>
		<input type="button" id="InputButtonDoIt" value="DoIt!" onclick="DoIt()">
	</body>
</html>